
{
  "entities": {
    "CommercialProperty": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CommercialProperty",
      "type": "object",
      "description": "Represents a commercial property data entry.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the commercial property."
        },
        "propertyName": {
          "type": "string",
          "description": "Name of the commercial property."
        },
        "address": {
          "type": "string",
          "description": "Address of the commercial property."
        },
        "propertyType": {
          "type": "string",
          "description": "Type of commercial property (e.g., Office, Retail)."
        },
        "squareFootage": {
          "type": "number",
          "description": "Square footage of the commercial property."
        },
        "rentalRate": {
          "type": "number",
          "description": "Rental rate of the commercial property."
        },
        "occupancyRate": {
          "type": "number",
          "description": "Occupancy rate of the commercial property."
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or comments about the commercial property."
        }
      },
      "required": [
        "id",
        "propertyName",
        "address",
        "propertyType",
        "squareFootage",
        "rentalRate",
        "occupancyRate"
      ]
    },
    "ResidentialProperty": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResidentialProperty",
      "type": "object",
      "description": "Represents a residential property data entry.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the residential property."
        },
        "propertyName": {
          "type": "string",
          "description": "Name of the residential property."
        },
        "address": {
          "type": "string",
          "description": "Address of the residential property."
        },
        "propertyType": {
          "type": "string",
          "description": "Type of residential property (e.g., Apartment, House)."
        },
        "numberOfUnits": {
          "type": "number",
          "description": "Number of units in the residential property."
        },
        "averageRent": {
          "type": "number",
          "description": "Average rent for units in the residential property."
        },
        "occupancyRate": {
          "type": "number",
          "description": "Occupancy rate of the residential property."
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or comments about the residential property."
        }
      },
      "required": [
        "id",
        "propertyName",
        "address",
        "propertyType",
        "numberOfUnits",
        "averageRent",
        "occupancyRate"
      ]
    },
    "HotelProperty": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "HotelProperty",
      "type": "object",
      "description": "Represents a hotel property data entry.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the hotel property."
        },
        "hotelName": {
          "type": "string",
          "description": "Name of the hotel property."
        },
        "address": {
          "type": "string",
          "description": "Address of the hotel property."
        },
        "starRating": {
          "type": "number",
          "description": "Star rating of the hotel property."
        },
        "numberOfRooms": {
          "type": "number",
          "description": "Number of rooms in the hotel property."
        },
        "averageDailyRate": {
          "type": "number",
          "description": "Average daily rate for rooms in the hotel property."
        },
        "occupancyRate": {
          "type": "number",
          "description": "Occupancy rate of the hotel property."
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or comments about the hotel property."
        }
      },
      "required": [
        "id",
        "hotelName",
        "address",
        "starRating",
        "numberOfRooms",
        "averageDailyRate",
        "occupancyRate"
      ]
    },
    "BankBranch": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BankBranch",
      "type": "object",
      "description": "Represents a bank branch data entry.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the bank branch."
        },
        "bankName": {
          "type": "string",
          "description": "Name of the bank."
        },
        "branchAddress": {
          "type": "string",
          "description": "Address of the bank branch."
        },
        "branchManager": {
          "type": "string",
          "description": "Name of the branch manager."
        },
        "numberOfEmployees": {
          "type": "number",
          "description": "Number of employees at the bank branch."
        },
        "totalDeposits": {
          "type": "number",
          "description": "Total deposits at the bank branch."
        },
        "totalLoans": {
          "type": "number",
          "description": "Total loans issued by the bank branch."
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or comments about the bank branch."
        }
      },
      "required": [
        "id",
        "bankName",
        "branchAddress",
        "branchManager",
        "numberOfEmployees",
        "totalDeposits",
        "totalLoans"
      ]
    },
    "ProjectInformation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectInformation",
      "type": "object",
      "description": "Represents a comprehensive project information form.",
      "properties": {},
      "additionalProperties": {
        "anyOf": [
          { "type": "string" },
          { "type": "boolean" }
        ]
      }
    },
    "PredesignAssessment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PredesignAssessment",
      "type": "object",
      "description": "Represents a predesign assessment form.",
      "properties": {},
      "additionalProperties": { "type": "string" }
    },
    "ProjectChecklist": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectChecklist",
      "type": "object",
      "description": "Represents a project checklist form.",
      "properties": {},
      "additionalProperties": {
        "anyOf": [
          { "type": "string" },
          { "type": "boolean" }
        ]
      }
    },
    "ProjectData": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectData",
      "type": "object",
      "description": "Represents a project data form.",
      "properties": {},
      "additionalProperties": {
        "anyOf": [
          { "type": "string" },
          { "type": "boolean" }
        ]
      }
    },
    "ProjectAgreement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectAgreement",
      "type": "object",
      "description": "Represents a project agreement form.",
      "properties": {},
      "additionalProperties": {
        "type": "string"
      }
    },
    "ProjectTimeline": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectTimeline",
      "type": "object",
      "description": "Represents the data for the project timeline page.",
      "properties": {
        "project": { "type": "string" },
        "architect": { "type": "string" },
        "nameAddress": { "type": "string" },
        "architectProjectNo": { "type": "string" },
        "projectDate": { "type": "string" },
        "tasks": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "number" },
              "name": { "type": "string" },
              "duration": { "type": "string" },
              "start": { "type": "string" },
              "finish": { "type": "string" },
              "predecessor": { "type": "string" }
            },
            "required": ["id", "name"]
          }
        }
      }
    },
    "TimelineProject": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TimelineProject",
      "description": "A flexible schema for timeline project data.",
      "type": "object",
      "properties": {
        "projectData": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "overallStatus": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "no": {"type": ["number", "string"]},
              "text": {"type": "string"}
            },
            "additionalProperties": true
          }
        },
        "remarks": {
          "type": "object",
          "properties": {
            "text": {"type": "string"},
            "date": {"type": "string"}
          }
        }
      },
      "additionalProperties": true
    },
    "WeeklyWorkSchedule": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WeeklyWorkSchedule",
      "description": "Represents the data for the weekly work schedule.",
      "type": "object",
      "properties": {
        "schedules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
                "id": { "type": "number" },
                "employeeName": { "type": "string" },
                "projectName": { "type": "string" },
                "details": { "type": "string" },
                "status": { "type": "string" },
                "startDate": { "type": "string" },
                "endDate": { "type": "string" }
            },
            "required": ["id"]
          }
        },
        "remarks": { "type": "string" }
      }
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/commercialProperties/{propertyId}",
        "definition": {
          "entityName": "CommercialProperty",
          "schema": {
            "$ref": "#/backend/entities/CommercialProperty"
          },
          "description": "Stores commercial property data owned by a specific user. Path-based ownership enforced via /users/{userId}. Includes 'userId' as the owner.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the commercial property."
            },
            {
              "name": "propertyId",
              "description": "The unique ID of the commercial property."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/residentialProperties/{propertyId}",
        "definition": {
          "entityName": "ResidentialProperty",
          "schema": {
            "$ref": "#/backend/entities/ResidentialProperty"
          },
          "description": "Stores residential property data owned by a specific user. Path-based ownership enforced via /users/{userId}. Includes 'userId' as the owner.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the residential property."
            },
            {
              "name": "propertyId",
              "description": "The unique ID of the residential property."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/hotelProperties/{propertyId}",
        "definition": {
          "entityName": "HotelProperty",
          "schema": {
            "$ref": "#/backend/entities/HotelProperty"
          },
          "description": "Stores hotel property data owned by a specific user. Path-based ownership enforced via /users/{userId}. Includes 'userId' as the owner.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the hotel property."
            },
            {
              "name": "propertyId",
              "description": "The unique ID of the hotel property."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/bankBranches/{propertyId}",
        "definition": {
          "entityName": "BankBranch",
          "schema": {
            "$ref": "#/backend/entities/BankBranch"
          },
          "description": "Stores bank branch data owned by a specific user. Path-based ownership enforced via /users/{userId}. Includes 'userId' as the owner.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the bank branch property."
            },
            {
              "name": "propertyId",
              "description": "The unique ID of the bank branch property."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/projectInformation/{infoId}",
        "definition": {
          "entityName": "ProjectInformation",
          "schema": {
            "$ref": "#/backend/entities/ProjectInformation"
          },
          "description": "Stores project information data for a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the information."
            },
            {
              "name": "infoId",
              "description": "The unique ID of the project information."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/predesignAssessments/{assessmentId}",
        "definition": {
          "entityName": "PredesignAssessment",
          "schema": {
            "$ref": "#/backend/entities/PredesignAssessment"
          },
          "description": "Stores predesign assessment data for a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the assessment."
            },
            {
              "name": "assessmentId",
              "description": "The unique ID of the predesign assessment."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/projectTimelines/{timelineId}",
        "definition": {
          "entityName": "TimelineProject",
          "schema": {
            "$ref": "#/entities/TimelineProject"
          },
          "description": "Stores project timeline data for a specific user."
        }
      },
      {
        "path": "/users/{userId}/projectChecklists/{checklistId}",
        "definition": {
          "entityName": "ProjectChecklist",
          "schema": {
            "$ref": "#/entities/ProjectChecklist"
          },
          "description": "Stores project checklist data for a specific user."
        }
      },
      {
        "path": "/users/{userId}/projectData/{dataId}",
        "definition": {
          "entityName": "ProjectData",
          "schema": {
            "$ref": "#/entities/ProjectData"
          },
          "description": "Stores project data form for a specific user."
        }
      },
      {
        "path": "/users/{userId}/projectAgreements/{agreementId}",
        "definition": {
          "entityName": "ProjectAgreement",
          "schema": {
            "$ref": "#/entities/ProjectAgreement"
          },
          "description": "Stores project agreement data for a specific user."
        }
      },
      {
        "path": "/users/{userId}/weeklySchedules/{scheduleId}",
        "definition": {
          "entityName": "WeeklyWorkSchedule",
          "schema": {
            "$ref": "#/entities/WeeklyWorkSchedule"
          },
          "description": "Stores weekly work schedule data for a specific user."
        }
      }
    ],
    "reasoning": "To address the user's requirement for saving and displaying data related to commercial, residential, hotel, and bank branch properties within the Isbah Dashboard application, I propose the following Firestore structure:\n\n*   **Authorization Independence:** Each property document (CommercialProperty, ResidentialProperty, HotelProperty, and BankBranch) will be stored under a path based on the user's ID. This eliminates the need for `get()` calls in security rules to check ownership, as the path itself establishes ownership. No membership maps are needed as ownership is implicit in the path.\n*   **Structural Segregation:** Each type of property (commercial, residential, hotel, and bank branch) is stored in its own top-level collection. This simplifies security rules by ensuring that all documents within a collection share the same access control requirements.\n*   **Clear Data Organization:** Properties are organized under user-specific subcollections to maintain data privacy and ownership.\n\nThis structure offers several advantages:\n\n*   **Security:** Access control is straightforward. Rules can easily restrict read/write access to only the owner of a specific `propertyId`.\n*   **Scalability:** Firestore's scalability is maximized by avoiding complex queries and hierarchical dependencies.\n*   **Debuggability:** The structure is simple and easy to understand, making it easier to debug security rules and data access issues.\n\nThis structure directly addresses the core design principles:\n\n*   **Authorization Independence:** The hierarchical path `/users/{userId}/{propertyType}/{propertyId}` ensures that ownership is inherent in the path structure, removing the need for `get()` calls to verify ownership.\n*   **Clarity of Intent:** The path-based ownership model clearly expresses the relationship between users and their properties.\n*   **DBAC (No Custom Claims):** Authorization relies solely on `request.auth.uid` and the path structure.\n*   **QAPs (Rules are not Filters):** The structure enables secure `list` operations. A user can only list properties under their `userId`, preventing unauthorized access to other users' properties.\n*   **Invariants:** Ownership and timestamps can be easily enforced via rules."
  }
}

    